using Firebase.Database;
using Firebase.Database.Query;
using System.Collections.ObjectModel;

namespace Tema2Exercici5
{

    public partial class MainPage : ContentPage
    {
        int count = 0;
        FirebaseClient firebaseClient = new FirebaseClient("https://exercici5tema2-default-rtdb.europe-west1.firebasedatabase.app/");
        public ObservableCollection<Tasca> Tasques { get; set; } = new ObservableCollection<Tasca>();
        
        public MainPage()
        {
            InitializeComponent();
            BindingContext = this;
            BindingContext = Tasca.Tasques;
        }

        private void btnAnyadir(object sender, EventArgs e)
        {
            if (eNombreTarea.Text != null && eNombreTarea.Text != string.Empty)
            {
                Tasca tasca = new Tasca
                {
                    IdTarea = string.Empty,
                    NombreTarea = eNombreTarea.Text,
                };
                string key = firebaseClient.Child("Tasques").PostAsync(tasca).Result.Key;
                if (key != null)
                {
                    firebaseClient.Child("Tasques").Child(key).PutAsync(
                    new Tasca
                    {
                        IdTarea = key,
                        NombreTarea = tasca.NombreTarea
                    });
                }
                eNombreTarea.Text = string.Empty;
            }

        }

        private void btnActualizar(object sender, EventArgs e)
        {

        }

        private void btnBorrar(object sender, EventArgs e)
        {

        }

    }

}
